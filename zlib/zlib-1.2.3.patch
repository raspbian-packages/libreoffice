--- misc/zlib-1.2.3/makefile.mk	Fri Mar 14 10:17:06 2008
+++ misc/build/zlib-1.2.3/makefile.mk	Fri Mar 14 10:16:56 2008
@@ -1 +1,73 @@
-dummy
+#*************************************************************************
+#
+#   Copyright according the GNU Public License.
+#
+#*************************************************************************
+
+PRJ=..$/..$/..$/..
+
+PRJNAME=zlib
+TARGET=zlib
+LIBTARGET=NO
+EXTERNAL_WARNINGS_NOT_ERRORS=TRUE
+
+# --- Settings -----------------------------------------------------
+
+.INCLUDE :  settings.mk
+
+# --- Files --------------------------------------------------------
+
+INCEXT=contrib$/minizip
+
+SLOFILES=	$(SLO)$/adler32.obj		\
+			$(SLO)$/compress.obj	\
+			$(SLO)$/deflate.obj		\
+			$(SLO)$/crc32.obj		\
+			$(SLO)$/inffast.obj		\
+			$(SLO)$/inflate.obj		\
+			$(SLO)$/inftrees.obj	\
+			$(SLO)$/infback.obj		\
+			$(SLO)$/trees.obj		\
+			$(SLO)$/zutil.obj       \
+			$(SLO)$/uncompr.obj		\
+			$(SLO)$/gzio.obj		\
+			$(SLO)$/unzip.obj		\
+			$(SLO)$/ioapi.obj
+
+
+LIB1TARGET=$(SLB)$/$(TARGET).lib
+LIB1ARCHIV=$(LB)$/lib$(TARGET).a
+LIB1OBJFILES=$(SLOFILES)
+
+.IF "$(BUILD_X64)"!=""
+SLOFILES_X64=	$(SLO_X64)$/adler32.obj		\
+			$(SLO_X64)$/compress.obj	\
+			$(SLO_X64)$/deflate.obj		\
+			$(SLO_X64)$/crc32.obj		\
+			$(SLO_X64)$/inffast.obj		\
+			$(SLO_X64)$/inflate.obj		\
+			$(SLO_X64)$/inftrees.obj	\
+			$(SLO_X64)$/infback.obj		\
+			$(SLO_X64)$/trees.obj		\
+			$(SLO_X64)$/zutil.obj       \
+			$(SLO_X64)$/uncompr.obj		\
+			$(SLO_X64)$/gzio.obj		\
+			$(SLO_X64)$/unzip.obj		\
+			$(SLO_X64)$/ioapi.obj
+
+LIB1TARGET_X64=$(SLB_X64)$/$(TARGET).lib
+LIB1OBJFILES_X64=$(SLOFILES_X64)
+.ENDIF # "$(BUILD_X64)"!=""
+
+
+# --- Targets ------------------------------------------------------
+
+$(MISC)$/%.c : contrib$/minizip$/%.c
+	@echo ------------------------------
+	@echo Making: $@
+    @$(COPY) $< $@
+
+.INCLUDE :  set_wntx64.mk
+.INCLUDE :  target.mk
+.INCLUDE :  tg_wntx64.mk
+
--- misc/zlib-1.2.3/zconf.h	2010-07-15 09:33:48.921875000 +0200
+++ misc/build/zlib-1.2.3/zconf.h	2010-07-15 09:39:27.000000000 +0200
@@ -12,6 +12,12 @@
  * If you *really* need a unique prefix for all types and library functions,
  * compile with -DZ_PREFIX. The "standard" zlib should be compiled without it.
  */
+/*
+ * we need the prefix to get the same names as in 1.1.3
+*/
+
+#define Z_PREFIX
+
 #ifdef Z_PREFIX
 #  define deflateInit_          z_deflateInit_
 #  define deflate               z_deflate
--- misc/zlib-1.2.3/zutil.h
+++ misc/build/zlib-1.2.3/zutil.h
@@ -175,7 +175,7 @@
 
          /* functions */
 
-#if defined(STDC99) || (defined(__TURBOC__) && __TURBOC__ >= 0x550)
+#if defined(STDC99) || (defined(__TURBOC__) && __TURBOC__ >= 0x550) || defined(_MSC_VER)
 #  ifndef HAVE_VSNPRINTF
 #    define HAVE_VSNPRINTF
 #  endif
